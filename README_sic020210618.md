# Sharing is Caring Python CDK in a Team Setting 

## Description

Using AWD CDK Python in a team setting needs to be thought out. Standards and general agreements on how the code will be leveraged should be discussed and agreed to within a team.

## Usage

### Installing | setup local dev environment

things to install :
  - aws cli
  - npm cdk
  - pip installs
  - docker
  - python3
  - venv - a virtual environment


### common development environment
cloud9 or other easy to setup local situation. Use common source, always do a pip update and install the requirements when starting out. (some gotchas on this if not going through lower envs and promoting into prod but always going to prod) Patch first fix later vs patch when required. Using common tags across the board, possibly setting up environments in the cdk.json and importing them.

### Folder structure ?

Here's a folder structure for a Pandoc document:

```
~/git-root/       # Root directory.
|- project-name/  # Folder used to store builded (output) files.
|- lambda/        # file to be pulled in by a lambda resource
|- diags/         # diagrams as code / not cdk but python
|- makefile       # Makefile useful for keeping commands easy to 
|- ~/envs/project # virtual environment path outside of git-root
```

### git merge feature branch into main for code-pipeline

```
$ git checkout main
$ git merge feature-001
Updating f42c576..3a0874c
Fast-forward
 files.* | 2 ++
 1 file changed, 2 insertions(+)
```

### cdk init - first time project
This will setup .gitignore keping out some files related to cdk including the vitural environment.

When setting up the python virtual environment if it is placed in ~/envs/project name for example it will keep it out of the git repo. 

### python virtual environment
Assume it is required but at the very least it is strongly encouraged. If someone is having issues with cdk ask for the output of `echo $VIRTUAL_ENV` make sure it is set to the virtual environment bin/activate file. In the makefile here it is $ENVPATH/bin/activate set at the top. 

### makefile
using a makefile keeps some repeatable commands handy and also shows how to build a single stack with cdk.

### branch work
How well does this translate into an automated pipeline, write in a feature branch and merge into main or an environment-deployment branch. At the very least the app.py becomes a spot of overlap, and type-os possibly not tested or used in feature branch might not show up until merged and trying to deploy.

Like micro services split the infrastructure into many stacks. Are these then seperate pipelines for deployment or all wrapped into one monolithic pipeline and repo? If shifted all the way left will the infra specific to a service be the only CDK in the pipeline?

Removing a stack from cdk will not cause it to be removed as a resource, need to do the `cdk destroy stack-name`

### docker and diskspace
note: cdk doesn't remove past images prune often

### profiles with cdk
--profile awsprofilename will pass in the context and access to cdk for running stack creation. In local development this might mean keeping track of which account to deploy which resources. How does this work in a pipeline?

### Template IaC
As CDK or otherwise setup repo(s) with tempalte code that is functional and cut'n'paste-able to refrence and possibly in an account to setup and tare down often. 

### dynamic code for deployment environments
Going from dev to qa into a uat and finally prod. Where is the configuration management, should it be in the code or pulled dynamically from account specific ssm params? Possibly leveraging AWS Systems Manager documents.

